import{Z as ze,v as Pe}from"./bootstrap-CmOIY23B.js";import{d as Ne,aa as Ue,r as s,c as W,e as Ge,g as se,o as Oe,w as _,m as j,n as $,v as me,z as Ze,B as V,F as pe,I as ce,x as Le,u as E,C as Q,D as Ie,E as Re,A as Je,j as Ke}from"../jse/index-index-Dn7Pga_E.js";import{_ as Qe}from"./page.vue_vue_type_script_setup_true_lang-B79NNVXE.js";const Ve=["onMousedown","onTouchstart"],ea=Ne({__name:"resize",props:{stickSize:{type:Number,default:8},parentScaleX:{type:Number,default:1},parentScaleY:{type:Number,default:1},isActive:{type:Boolean,default:!1},preventActiveBehavior:{type:Boolean,default:!1},isDraggable:{type:Boolean,default:!0},isResizable:{type:Boolean,default:!0},aspectRatio:{type:Boolean,default:!1},parentLimitation:{type:Boolean,default:!1},snapToGrid:{type:Boolean,default:!1},gridX:{type:Number,default:50,validator(n){return n>=0}},gridY:{type:Number,default:50,validator(n){return n>=0}},parentW:{type:Number,default:0,validator(n){return n>=0}},parentH:{type:Number,default:0,validator(n){return n>=0}},w:{type:[String,Number],default:200,validator(n){return typeof n=="string"?n==="auto":n>=0}},h:{type:[String,Number],default:200,validator(n){return typeof n=="string"?n==="auto":n>=0}},minw:{type:Number,default:50,validator(n){return n>=0}},minh:{type:Number,default:50,validator(n){return n>=0}},x:{type:Number,default:0,validator(n){return typeof n=="number"}},y:{type:Number,default:0,validator(n){return typeof n=="number"}},z:{type:[String,Number],default:"auto",validator(n){return typeof n=="string"?n==="auto":n>=0}},dragHandle:{type:String,default:null},dragCancel:{type:String,default:null},sticks:{type:Array,default(){return["tl","tm","tr","mr","br","bm","bl","ml"]}},axis:{type:String,default:"both",validator(n){return["both","none","x","y"].includes(n)}},contentClass:{type:String,required:!1,default:""}},emits:["clicked","dragging","dragstop","resizing","resizestop","activated","deactivated"],setup(n,{emit:ee}){const q=n,x=ee,S={y:{t:"top",m:"marginTop",b:"bottom"},x:{l:"left",m:"marginLeft",r:"right"}};function z(e){e.forEach((a,t)=>{document.documentElement.addEventListener(t,a)})}function L(e){e.forEach((a,t)=>{document.documentElement.removeEventListener(t,a)})}const{stickSize:h,parentScaleX:R,parentScaleY:fe,isActive:de,preventActiveBehavior:ge,isDraggable:Ce,isResizable:he,aspectRatio:ae,parentLimitation:xe,snapToGrid:F,gridX:y,gridY:b,parentW:ye,parentH:be,w:P,h:U,minw:C,minh:T,x:we,y:Me,z:Te,dragHandle:te,dragCancel:le,sticks:De,axis:Ee,contentClass:ke}=Ue(q),D=s(!1),Se=s(null),c=s(null),f=s(null),v=s(null),r=s(null),w=s(null),M=s(null),i=s(null),B=s(!1),X=s(!1),o=s({pointerX:0,pointerY:0,x:0,y:0,w:0,h:0,top:0,right:0,bottom:0,left:0,width:0,height:0}),N=s({left:{min:null,max:null},right:{min:null,max:null},top:{min:null,max:null},bottom:{min:null,max:null}}),Y=s(null),ue=s(null),d=W(()=>c.value-v.value-w.value),g=W(()=>f.value-r.value-M.value),H=W(()=>({left:Math.round(v.value),top:Math.round(r.value),width:Math.round(d.value),height:Math.round(g.value)})),Be=({pointerX:e,pointerY:a})=>{o.value.pointerX=e,o.value.pointerY=a,o.value.left=v.value,o.value.right=w.value,o.value.top=r.value,o.value.bottom=M.value,o.value.width=d.value,o.value.height=g.value,i.value=d.value/g.value},G=(e,a)=>{let t=a;return e.min!==null&&a<e.min?t=e.min:e.max!==null&&e.max<a&&(t=e.max),t},Xe=e=>{let{newRight:a,newLeft:t,newBottom:l,newTop:u}=e;return t=G(N.value.left,t),a=G(N.value.right,a),u=G(N.value.top,u),l=G(N.value.bottom,l),{newLeft:t,newRight:a,newTop:u,newBottom:l}},$e=e=>{let{newLeft:a,newRight:t,newTop:l,newBottom:u}=e,p=c.value-a-t,m=f.value-l-u;if(Y.value[1]==="m"){const k=m-o.value.height;a-=k*i.value/2,t-=k*i.value/2}else if(Y.value[0]==="m"){const k=p-o.value.width;l-=k/i.value/2,u-=k/i.value/2}else p/m>i.value?(p=i.value*m,Y.value[1]==="l"?a=c.value-t-p:t=c.value-a-p):(m=p/i.value,Y.value[0]==="t"?l=f.value-u-m:u=f.value-l-m);return{newLeft:a,newRight:t,newTop:l,newBottom:u}},ne=e=>{let a=o.value.top,t=o.value.bottom,l=o.value.left,u=o.value.right;switch(Y.value[0]){case"b":{t=o.value.bottom+e.y,F.value&&(t=f.value-Math.round((f.value-t)/b.value)*b.value);break}case"t":{a=o.value.top-e.y,F.value&&(a=Math.round(a/b.value)*b.value);break}}switch(Y.value[1]){case"l":{l=o.value.left-e.x,F.value&&(l=Math.round(l/y.value)*y.value);break}case"r":{u=o.value.right+e.x,F.value&&(u=c.value-Math.round((c.value-u)/y.value)*y.value);break}}({newLeft:l,newRight:u,newTop:a,newBottom:t}=Xe({newLeft:l,newRight:u,newTop:a,newBottom:t})),ae.value&&({newLeft:l,newRight:u,newTop:a,newBottom:t}=$e({newLeft:l,newRight:u,newTop:a,newBottom:t})),v.value=l,w.value=u,r.value=a,M.value=t,x("resizing",H.value)},oe=()=>{B.value=!1,Object.assign(o.value,{pointerX:0,pointerY:0,x:0,y:0,w:0,h:0}),N.value={left:{min:null,max:null},right:{min:null,max:null},top:{min:null,max:null},bottom:{min:null,max:null}},x("resizing",H.value),x("resizestop",H.value)},He=()=>({left:{min:0,max:c.value-d.value},right:{min:0,max:c.value-d.value},top:{min:0,max:f.value-g.value},bottom:{min:0,max:f.value-g.value}}),Ae=()=>{const e=xe.value?0:null;ae.value&&(C.value/T.value>i.value?T.value=C.value/i.value:C.value=i.value*T.value);const a={left:{min:e,max:v.value+(d.value-C.value)},right:{min:e,max:w.value+(d.value-C.value)},top:{min:e,max:r.value+(g.value-T.value)},bottom:{min:e,max:M.value+(g.value-T.value)}};if(ae.value){const t={left:{min:v.value-Math.min(r.value,M.value)*i.value*2,max:v.value+(g.value-T.value)/2*i.value*2},right:{min:w.value-Math.min(r.value,M.value)*i.value*2,max:w.value+(g.value-T.value)/2*i.value*2},top:{min:r.value-Math.min(v.value,w.value)/i.value*2,max:r.value+(d.value-C.value)/2/i.value*2},bottom:{min:M.value-Math.min(v.value,w.value)/i.value*2,max:M.value+(d.value-C.value)/2/i.value*2}};Y.value[0]==="m"?(a.left={min:Math.max(a.left.min,t.left.min),max:Math.min(a.left.max,t.left.max)},a.right={min:Math.max(a.right.min,t.right.min),max:Math.min(a.right.max,t.right.max)}):Y.value[1]==="m"&&(a.top={min:Math.max(a.top.min,t.top.min),max:Math.min(a.top.max,t.top.max)},a.bottom={min:Math.max(a.bottom.min,t.bottom.min),max:Math.min(a.bottom.max,t.bottom.max)})}return a},We=W(()=>({top:`${r.value}px`,left:`${v.value}px`,zIndex:Se.value})),je=W(()=>({width:P.value==="auto"?"auto":`${d.value}px`,height:U.value==="auto"?"auto":`${g.value}px`})),qe=W(()=>e=>({width:`${h.value/R.value}px`,height:`${h.value/fe.value}px`,[S.y[e[0]]]:`${h.value/R.value/-2}px`,[S.x[e[1]]]:`${h.value/R.value/-2}px`})),ie=e=>{let a=o.value.top-e.y,t=o.value.bottom+e.y,l=o.value.left-e.x,u=o.value.right+e.x;if(F.value){let p=!0,m=!0,k=a-Math.floor(a/b.value)*b.value,I=f.value-t-Math.floor((f.value-t)/b.value)*b.value,J=l-Math.floor(l/y.value)*y.value,K=c.value-u-Math.floor((c.value-u)/y.value)*y.value;k>b.value/2&&(k-=b.value),I>b.value/2&&(I-=b.value),J>y.value/2&&(J-=y.value),K>y.value/2&&(K-=y.value),Math.abs(I)<Math.abs(k)&&(p=!1),Math.abs(K)<Math.abs(J)&&(m=!1),a-=p?k:I,t=f.value-g.value-a,l-=m?J:K,u=c.value-d.value-l}({newLeft:v.value,newRight:w.value,newTop:r.value,newBottom:M.value}=Xe({newLeft:l,newRight:u,newTop:a,newBottom:t})),x("dragging",H.value)},ve=()=>{X.value=!1,x("dragging",H.value),x("dragstop",H.value),Object.assign(o.value,{pointerX:0,pointerY:0,x:0,y:0,w:0,h:0}),N.value={left:{min:null,max:null},right:{min:null,max:null},top:{min:null,max:null},bottom:{min:null,max:null}}},O=(e,a,t=!1)=>{if((!he.value||!D.value)&&!t)return;B.value=!0;const l=a.pageX===void 0?a.touches[0].pageX:a.pageX,u=a.pageY===void 0?a.touches[0].pageY:a.pageY;Be({pointerX:l,pointerY:u}),Y.value=e,N.value=Ae()},Ye=e=>{if(!B.value&&!X.value)return;e.stopPropagation();const a=e.pageX===void 0?e.touches[0].pageX:e.pageX,t=e.pageY===void 0?e.touches[0].pageY:e.pageY,l={x:(o.value.pointerX-a)/R.value,y:(o.value.pointerY-t)/fe.value};if(B.value&&ne(l),X.value){switch(Ee.value){case"none":return;case"x":{l.y=0;break}case"y":{l.x=0;break}}ie(l)}},A=()=>{B.value?oe():X.value&&ve()},Fe=()=>{ge.value||(D.value=!1)},_e=s(new Map([["mousedown",Fe],["mouseleave",A],["mousemove",Ye],["mouseup",A],["touchcancel",A],["touchend",A],["touchmove",Ye],["touchstart",A]])),re=s();Ge(()=>{var t,l,u,p;const e=se(),a=e==null?void 0:e.vnode.el;ue.value=a==null?void 0:a.parentNode,c.value=(l=ye.value)!=null?l:(t=ue.value)==null?void 0:t.clientWidth,f.value=(p=be.value)!=null?p:(u=ue.value)==null?void 0:u.clientHeight,v.value=we.value,r.value=Me.value,w.value=c.value-(P.value==="auto"?re.value.scrollWidth:P.value)-v.value,M.value=f.value-(U.value==="auto"?re.value.scrollHeight:U.value)-r.value,z(_e.value),te.value&&[...(a==null?void 0:a.querySelectorAll(te.value))||[]].forEach(m=>{m.dataset.dragHandle=String(e==null?void 0:e.uid)}),le.value&&[...(a==null?void 0:a.querySelectorAll(le.value))||[]].forEach(m=>{m.dataset.dragCancel=String(e==null?void 0:e.uid)})}),Oe(()=>{L(_e.value)});const Z=e=>{var p,m;const{target:a,button:t}=e;if(ge.value||(D.value=!0),t&&t!==0||(x("clicked",e),!D.value)||te.value&&a.dataset.dragHandle!==((p=se())==null?void 0:p.uid.toString())||le.value&&a.dataset.dragCancel===((m=se())==null?void 0:m.uid.toString()))return;e.stopPropagation!==void 0&&e.stopPropagation(),e.preventDefault!==void 0&&e.preventDefault(),Ce.value&&(X.value=!0);const l=e.pageX===void 0?e.touches[0].pageX:e.pageX,u=e.pageY===void 0?e.touches[0].pageY:e.pageY;Be({pointerX:l,pointerY:u}),xe.value&&(N.value=He())};return _(()=>D.value,e=>{x(e?"activated":"deactivated")}),_(()=>de.value,e=>{D.value=e},{immediate:!0}),_(()=>Te.value,e=>{(e>=0||e==="auto")&&(Se.value=e)},{immediate:!0}),_(()=>we.value,(e,a)=>{if(B.value||X.value||e===v.value)return;const t=a-e;Z({pageX:v.value,pageY:r.value}),ie({x:t,y:0}),Q(()=>{ve()})}),_(()=>Me.value,(e,a)=>{if(B.value||X.value||e===r.value)return;const t=a-e;Z({pageX:v.value,pageY:r.value}),ie({x:0,y:t}),Q(()=>{ve()})}),_(()=>P.value,(e,a)=>{if(B.value||X.value||e===d.value)return;const t="mr",l=a-e;O(t,{pageX:w.value,pageY:r.value+g.value/2},!0),ne({x:l,y:0}),Q(()=>{oe()})}),_(()=>U.value,(e,a)=>{if(B.value||X.value||e===g.value)return;const t="bm",l=a-e;O(t,{pageX:v.value+d.value/2,pageY:M.value},!0),ne({x:0,y:l}),Q(()=>{oe()})}),_(()=>ye.value,e=>{w.value=e-d.value-v.value,c.value=e}),_(()=>be.value,e=>{M.value=e-g.value-r.value,f.value=e}),(e,a)=>($(),j("div",{class:Le([`${D.value||E(de)?"active":"inactive"} ${E(ke)?E(ke):""}`,"resize"]),style:V(We.value),onMousedown:a[0]||(a[0]=t=>Z(t)),onTouchend:A,onTouchstart:a[1]||(a[1]=t=>Z(t))},[me("div",{ref_key:"container",ref:re,style:V(je.value),class:"content-container"},[Ze(e.$slots,"default",{},void 0,!0)],4),($(!0),j(pe,null,ce(E(De),(t,l)=>($(),j("div",{key:l,class:Le([[`resize-stick-${t}`,E(he)?"":"not-resizable"],"resize-stick"]),style:V(qe.value(t)),onMousedown:ze(u=>O(t,u),["stop","prevent"]),onTouchstart:ze(u=>O(t,u),["stop","prevent"])},null,46,Ve))),128))],38))}}),aa=Pe(ea,[["__scopeId","data-v-86001e95"]]),ta={class:"m-4 bg-blue-500 p-48 text-xl"},oa=Ne({__name:"basic",setup(n){const ee=["red","green","yellow","gray"],q=s([{height:200,left:200,top:200,width:200},{height:300,left:300,top:300,width:300},{height:400,left:400,top:400,width:400},{height:500,left:500,top:500,width:500}]),x=(S,z)=>{!S||!z||(S.height=z.height,S.left=z.left,S.top=z.top,S.width=z.width)};return(S,z)=>($(),Ie(E(Qe),{description:"Resize组件基础示例",title:"Resize组件"},{default:Re(()=>[me("div",ta,[($(!0),j(pe,null,ce(q.value,L=>($(),j("div",{key:L.width},Je(`width: ${L.width}px, height: ${L.height}px, top: ${L.top}px, left: ${L.left}px`),1))),128))]),($(),j(pe,null,ce(4,(L,h)=>Ke(E(aa),{key:h,h:100*(h+1),w:100*(h+1),x:100*(h+1),y:100*(h+1),onDragging:R=>x(q.value[h],R),onResizing:R=>x(q.value[h],R)},{default:Re(()=>[me("div",{style:V({backgroundColor:ee[h]}),class:"h-full w-full"},null,4)]),_:2},1032,["h","w","x","y","onDragging","onResizing"])),64))]),_:1}))}});export{oa as default};
