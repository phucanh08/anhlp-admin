var be=Object.defineProperty,we=Object.defineProperties;var xe=Object.getOwnPropertyDescriptors;var ue=Object.getOwnPropertySymbols;var Pe=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable;var oe=r=>{throw TypeError(r)};var ae=(r,e,t)=>e in r?be(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,c=(r,e)=>{for(var t in e||(e={}))Pe.call(e,t)&&ae(r,t,e[t]);if(ue)for(var t of ue(e))Ae.call(e,t)&&ae(r,t,e[t]);return r},p=(r,e)=>we(r,xe(e));var G=(r,e,t)=>e.has(r)||oe("Cannot "+t);var i=(r,e,t)=>(G(r,e,"read from private field"),t?t.call(r):e.get(r)),d=(r,e,t)=>e.has(r)?oe("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),l=(r,e,t,s)=>(G(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t),w=(r,e,t)=>(G(r,e,"access private method"),t);var U=(r,e,t,s)=>({set _(n){l(r,e,n,t)},get _(){return i(r,e,s)}});var _=(r,e,t)=>new Promise((s,n)=>{var u=y=>{try{h(t.next(y))}catch(R){n(R)}},o=y=>{try{h(t.throw(y))}catch(R){n(R)}},h=y=>y.done?s(y.value):Promise.resolve(y.value).then(u,o);h((t=t.apply(r,e)).next())});import{R as qe,c as Ee,n as g,S as Ce,m as he,d as M,h as Oe,f as Re,g as ce,i as Se,o as le,r as fe,j as Fe,l as de,p as ye,s as Ie,q as a,t as Te,v as Ke}from"./useBaseQuery-2uhPjY7o.js";import{C as tt,Q as st,V as rt,x as it,k as nt,y as ut,z as at,A as ot,w as ht}from"./useBaseQuery-2uhPjY7o.js";import{i as pe}from"./useInfiniteQuery-sruTb_LB.js";import{I as lt,u as ft}from"./useInfiniteQuery-sruTb_LB.js";import{r as ke,C as He}from"../jse/index-index-Dn7Pga_E.js";import{u as yt}from"./useQuery-MkQhxMhz.js";var K,C,Q,E,O,x,me,Ue=(me=class extends qe{constructor(e){super();d(this,O);d(this,K);d(this,C);d(this,Q);d(this,E);l(this,K,e.client),this.mutationId=e.mutationId,l(this,Q,e.mutationCache),l(this,C,[]),this.state=e.state||_e(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){i(this,C).includes(e)||(i(this,C).push(e),this.clearGcTimeout(),i(this,Q).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){l(this,C,i(this,C).filter(t=>t!==e)),this.scheduleGc(),i(this,Q).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){i(this,C).length||(this.state.status==="pending"?this.scheduleGc():i(this,Q).remove(this))}continue(){var e,t;return(t=(e=i(this,E))==null?void 0:e.continue())!=null?t:this.execute(this.state.variables)}execute(e){return _(this,null,function*(){var o,h,y,R,B,N,V,$,z,L,Y,J,X,Z,W,ee,te,se,re,ie,ne;const t=()=>{w(this,O,x).call(this,{type:"continue"})},s={client:i(this,K),meta:this.options.meta,mutationKey:this.options.mutationKey};l(this,E,Ee({fn:()=>this.options.mutationFn?this.options.mutationFn(e,s):Promise.reject(new Error("No mutationFn found")),onFail:(m,H)=>{w(this,O,x).call(this,{type:"failed",failureCount:m,error:H})},onPause:()=>{w(this,O,x).call(this,{type:"pause"})},onContinue:t,retry:(o=this.options.retry)!=null?o:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>i(this,Q).canRun(this)}));const n=this.state.status==="pending",u=!i(this,E).canStart();try{if(n)t();else{w(this,O,x).call(this,{type:"pending",variables:e,isPaused:u}),yield(y=(h=i(this,Q).config).onMutate)==null?void 0:y.call(h,e,this,s);const H=yield(B=(R=this.options).onMutate)==null?void 0:B.call(R,e,s);H!==this.state.context&&w(this,O,x).call(this,{type:"pending",context:H,variables:e,isPaused:u})}const m=yield i(this,E).start();return yield(V=(N=i(this,Q).config).onSuccess)==null?void 0:V.call(N,m,e,this.state.context,this,s),yield(z=($=this.options).onSuccess)==null?void 0:z.call($,m,e,this.state.context,s),yield(Y=(L=i(this,Q).config).onSettled)==null?void 0:Y.call(L,m,null,this.state.variables,this.state.context,this,s),yield(X=(J=this.options).onSettled)==null?void 0:X.call(J,m,null,e,this.state.context,s),w(this,O,x).call(this,{type:"success",data:m}),m}catch(m){try{throw yield(W=(Z=i(this,Q).config).onError)==null?void 0:W.call(Z,m,e,this.state.context,this,s),yield(te=(ee=this.options).onError)==null?void 0:te.call(ee,m,e,this.state.context,s),yield(re=(se=i(this,Q).config).onSettled)==null?void 0:re.call(se,void 0,m,this.state.variables,this.state.context,this,s),yield(ne=(ie=this.options).onSettled)==null?void 0:ne.call(ie,void 0,m,e,this.state.context,s),m}finally{w(this,O,x).call(this,{type:"error",error:m})}}finally{i(this,Q).runNext(this)}})}},K=new WeakMap,C=new WeakMap,Q=new WeakMap,E=new WeakMap,O=new WeakSet,x=function(e){const t=s=>{switch(e.type){case"failed":return p(c({},s),{failureCount:e.failureCount,failureReason:e.error});case"pause":return p(c({},s),{isPaused:!0});case"continue":return p(c({},s),{isPaused:!1});case"pending":return p(c({},s),{context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()});case"success":return p(c({},s),{data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1});case"error":return p(c({},s),{data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"})}};this.state=t(this.state),g.batch(()=>{i(this,C).forEach(s=>{s.onMutationUpdate(e)}),i(this,Q).notify({mutation:this,type:"updated",action:e})})},me);function _e(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var b,v,k,Qe,De=(Qe=class extends Ce{constructor(t={}){super();d(this,b);d(this,v);d(this,k);this.config=t,l(this,b,new Set),l(this,v,new Map),l(this,k,0)}build(t,s,n){const u=new Ue({client:t,mutationCache:this,mutationId:++U(this,k)._,options:t.defaultMutationOptions(s),state:n});return this.add(u),u}add(t){i(this,b).add(t);const s=j(t);if(typeof s=="string"){const n=i(this,v).get(s);n?n.push(t):i(this,v).set(s,[t])}this.notify({type:"added",mutation:t})}remove(t){if(i(this,b).delete(t)){const s=j(t);if(typeof s=="string"){const n=i(this,v).get(s);if(n)if(n.length>1){const u=n.indexOf(t);u!==-1&&n.splice(u,1)}else n[0]===t&&i(this,v).delete(s)}}this.notify({type:"removed",mutation:t})}canRun(t){const s=j(t);if(typeof s=="string"){const n=i(this,v).get(s),u=n==null?void 0:n.find(o=>o.state.status==="pending");return!u||u===t}else return!0}runNext(t){var n,u;const s=j(t);if(typeof s=="string"){const o=(n=i(this,v).get(s))==null?void 0:n.find(h=>h!==t&&h.state.isPaused);return(u=o==null?void 0:o.continue())!=null?u:Promise.resolve()}else return Promise.resolve()}clear(){g.batch(()=>{i(this,b).forEach(t=>{this.notify({type:"removed",mutation:t})}),i(this,b).clear(),i(this,v).clear()})}getAll(){return Array.from(i(this,b))}find(t){const s=c({exact:!0},t);return this.getAll().find(n=>he(s,n))}findAll(t={}){return this.getAll().filter(s=>he(t,s))}notify(t){g.batch(()=>{this.listeners.forEach(s=>{s(t)})})}resumePausedMutations(){const t=this.getAll().filter(s=>s.state.isPaused);return g.batch(()=>Promise.all(t.map(s=>s.continue().catch(M))))}},b=new WeakMap,v=new WeakMap,k=new WeakMap,Qe);function j(r){var e;return(e=r.options.scope)==null?void 0:e.id}var D,ge,Me=(ge=class extends Ce{constructor(t={}){super();d(this,D);this.config=t,l(this,D,new Map)}build(t,s,n){var y;const u=s.queryKey,o=(y=s.queryHash)!=null?y:Oe(u,s);let h=this.get(o);return h||(h=new Re({client:t,queryKey:u,queryHash:o,options:t.defaultQueryOptions(s),state:n,defaultOptions:t.getQueryDefaults(u)}),this.add(h)),h}add(t){i(this,D).has(t.queryHash)||(i(this,D).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const s=i(this,D).get(t.queryHash);s&&(t.destroy(),s===t&&i(this,D).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){g.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return i(this,D).get(t)}getAll(){return[...i(this,D).values()]}find(t){const s=c({exact:!0},t);return this.getAll().find(n=>ce(s,n))}findAll(t={}){const s=this.getAll();return Object.keys(t).length>0?s.filter(n=>ce(t,n)):s}notify(t){g.batch(()=>{this.listeners.forEach(s=>{s(t)})})}onFocus(){g.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){g.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},D=new WeakMap,ge),f,P,A,S,F,q,I,T,ve,je=(ve=class{constructor(e={}){d(this,f);d(this,P);d(this,A);d(this,S);d(this,F);d(this,q);d(this,I);d(this,T);l(this,f,e.queryCache||new Me),l(this,P,e.mutationCache||new De),l(this,A,e.defaultOptions||{}),l(this,S,new Map),l(this,F,new Map),l(this,q,0)}mount(){U(this,q)._++,i(this,q)===1&&(l(this,I,Se.subscribe(e=>_(this,null,function*(){e&&(yield this.resumePausedMutations(),i(this,f).onFocus())}))),l(this,T,le.subscribe(e=>_(this,null,function*(){e&&(yield this.resumePausedMutations(),i(this,f).onOnline())}))))}unmount(){var e,t;U(this,q)._--,i(this,q)===0&&((e=i(this,I))==null||e.call(this),l(this,I,void 0),(t=i(this,T))==null||t.call(this),l(this,T,void 0))}isFetching(e){return i(this,f).findAll(p(c({},e),{fetchStatus:"fetching"})).length}isMutating(e){return i(this,P).findAll(p(c({},e),{status:"pending"})).length}getQueryData(e){var s;const t=this.defaultQueryOptions({queryKey:e});return(s=i(this,f).get(t.queryHash))==null?void 0:s.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=i(this,f).build(this,t),n=s.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(fe(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return i(this,f).findAll(e).map(({queryKey:t,state:s})=>{const n=s.data;return[t,n]})}setQueryData(e,t,s){const n=this.defaultQueryOptions({queryKey:e}),u=i(this,f).get(n.queryHash),o=u==null?void 0:u.state.data,h=Fe(t,o);if(h!==void 0)return i(this,f).build(this,n).setData(h,p(c({},s),{manual:!0}))}setQueriesData(e,t,s){return g.batch(()=>i(this,f).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,s)]))}getQueryState(e){var s;const t=this.defaultQueryOptions({queryKey:e});return(s=i(this,f).get(t.queryHash))==null?void 0:s.state}removeQueries(e){const t=i(this,f);g.batch(()=>{t.findAll(e).forEach(s=>{t.remove(s)})})}resetQueries(e,t){const s=i(this,f);return g.batch(()=>(s.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries(c({type:"active"},e),t)))}cancelQueries(e,t={}){const s=c({revert:!0},t),n=g.batch(()=>i(this,f).findAll(e).map(u=>u.cancel(s)));return Promise.all(n).then(M).catch(M)}invalidateQueries(e,t={}){return g.batch(()=>{var s,n;return i(this,f).findAll(e).forEach(u=>{u.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries(p(c({},e),{type:(n=(s=e==null?void 0:e.refetchType)!=null?s:e==null?void 0:e.type)!=null?n:"active"}),t)})}refetchQueries(e,t={}){var u;const s=p(c({},t),{cancelRefetch:(u=t.cancelRefetch)!=null?u:!0}),n=g.batch(()=>i(this,f).findAll(e).filter(o=>!o.isDisabled()&&!o.isStatic()).map(o=>{let h=o.fetch(void 0,s);return s.throwOnError||(h=h.catch(M)),o.state.fetchStatus==="paused"?Promise.resolve():h}));return Promise.all(n).then(M)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const s=i(this,f).build(this,t);return s.isStaleByTime(fe(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(M).catch(M)}fetchInfiniteQuery(e){return e.behavior=pe(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(M).catch(M)}ensureInfiniteQueryData(e){return e.behavior=pe(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return le.isOnline()?i(this,P).resumePausedMutations():Promise.resolve()}getQueryCache(){return i(this,f)}getMutationCache(){return i(this,P)}getDefaultOptions(){return i(this,A)}setDefaultOptions(e){l(this,A,e)}setQueryDefaults(e,t){i(this,S).set(de(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...i(this,S).values()],s={};return t.forEach(n=>{ye(e,n.queryKey)&&Object.assign(s,n.defaultOptions)}),s}setMutationDefaults(e,t){i(this,F).set(de(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...i(this,F).values()],s={};return t.forEach(n=>{ye(e,n.mutationKey)&&Object.assign(s,n.defaultOptions)}),s}defaultQueryOptions(e){if(e._defaulted)return e;const t=p(c(c(c({},i(this,A).queries),this.getQueryDefaults(e.queryKey)),e),{_defaulted:!0});return t.queryHash||(t.queryHash=Oe(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Ie&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:p(c(c(c({},i(this,A).mutations),(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey)),e),{_defaulted:!0})}clear(){i(this,f).clear(),i(this,P).clear()}},f=new WeakMap,P=new WeakMap,A=new WeakMap,S=new WeakMap,F=new WeakMap,q=new WeakMap,I=new WeakMap,T=new WeakMap,ve),Ge=class extends Me{find(r){return super.find(a(r))}findAll(r={}){return super.findAll(a(r))}},Be=class extends De{find(r){return super.find(a(r))}findAll(r={}){return super.findAll(a(r))}},Ne=class extends je{constructor(r={}){const e={defaultOptions:r.defaultOptions,queryCache:r.queryCache||new Ge,mutationCache:r.mutationCache||new Be};super(e),this.isRestoring=ke(!1)}isFetching(r={}){return super.isFetching(a(r))}isMutating(r={}){return super.isMutating(a(r))}getQueryData(r){return super.getQueryData(a(r))}ensureQueryData(r){return super.ensureQueryData(a(r))}getQueriesData(r){return super.getQueriesData(a(r))}setQueryData(r,e,t={}){return super.setQueryData(a(r),e,a(t))}setQueriesData(r,e,t={}){return super.setQueriesData(a(r),e,a(t))}getQueryState(r){return super.getQueryState(a(r))}removeQueries(r={}){return super.removeQueries(a(r))}resetQueries(r={},e={}){return super.resetQueries(a(r),a(e))}cancelQueries(r={},e={}){return super.cancelQueries(a(r),a(e))}invalidateQueries(r={},e={}){var u,o;const t=a(r),s=a(e);if(super.invalidateQueries(p(c({},t),{refetchType:"none"}),s),t.refetchType==="none")return Promise.resolve();const n=p(c({},t),{type:(o=(u=t.refetchType)!=null?u:t.type)!=null?o:"active"});return He().then(()=>super.refetchQueries(n,s))}refetchQueries(r={},e={}){return super.refetchQueries(a(r),a(e))}fetchQuery(r){return super.fetchQuery(a(r))}prefetchQuery(r){return super.prefetchQuery(a(r))}fetchInfiniteQuery(r){return super.fetchInfiniteQuery(a(r))}prefetchInfiniteQuery(r){return super.prefetchInfiniteQuery(a(r))}setDefaultOptions(r){super.setDefaultOptions(a(r))}setQueryDefaults(r,e){super.setQueryDefaults(a(r),a(e))}getQueryDefaults(r){return super.getQueryDefaults(a(r))}setMutationDefaults(r,e){super.setMutationDefaults(a(r),a(e))}getMutationDefaults(r){return super.getMutationDefaults(a(r))}},Ze={install:(r,e={})=>{const t=Te(e.queryClientKey);let s;if("queryClient"in e&&e.queryClient)s=e.queryClient;else{const o="queryClientConfig"in e?e.queryClientConfig:void 0;s=new Ne(o)}Ke||s.mount();let n=()=>{};if(e.clientPersister){s.isRestoring&&(s.isRestoring.value=!0);const[o,h]=e.clientPersister(s);n=o,h.then(()=>{var y;s.isRestoring&&(s.isRestoring.value=!1),(y=e.clientPersisterOnSuccess)==null||y.call(e,s)})}const u=()=>{s.unmount(),n()};if(r.onUnmount)r.onUnmount(u);else{const o=r.unmount;r.unmount=function(){u(),o()}}r.provide(t,s)}};export{tt as CancelledError,lt as InfiniteQueryObserver,Ue as Mutation,Be as MutationCache,Re as Query,Ge as QueryCache,Ne as QueryClient,st as QueryObserver,rt as VUE_QUERY_CLIENT,Ze as VueQueryPlugin,it as defaultScheduler,Se as focusManager,de as hashKey,Ke as isServer,nt as keepPreviousData,he as matchMutation,ce as matchQuery,M as noop,g as notifyManager,le as onlineManager,ye as partialMatchKey,ut as replaceEqualDeep,at as shouldThrowError,Ie as skipToken,ot as timeoutManager,ft as useInfiniteQuery,yt as useQuery,ht as useQueryClient};
