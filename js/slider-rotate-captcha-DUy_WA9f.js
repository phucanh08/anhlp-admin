var W=Object.defineProperty;var y=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var b=(o,s,r)=>s in o?W(o,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[s]=r,M=(o,s)=>{for(var r in s||(s={}))j.call(s,r)&&b(o,r,s[r]);if(y)for(var r of y(s))U.call(s,r)&&b(o,r,s[r]);return o};import{C as q}from"./index-18-lVBa-.js";import{$ as _,ac as X,A as Z}from"./bootstrap-CmOIY23B.js";import{_ as G}from"./index.vue_vue_type_script_setup_true_lang-CcnCQVvY.js";import{d as C,L as $,l as H,b as J,M as K,w as Q,c as d,m as x,n as f,v as p,j as R,B,x as V,q as k,A as z,u as c,ac as Y,I as ee,E as S,z as te,R as ae,S as se,ad as re,$ as oe,D as ie}from"../jse/index-index-Dn7Pga_E.js";import{_ as ne}from"./page.vue_vue_type_script_setup_true_lang-B79NNVXE.js";import"./index-Cq5upoUv.js";import"./shallowequal-BOWVaEXw.js";import"./Trigger-B0Zd1YSB.js";import"./ResizeObserver.es-CDE7jhPe.js";import"./collapse-BuqCI_Sc.js";import"./Overflow-D-n6m9kG.js";import"./index-bMV-OEX7.js";import"./index-BuhGstFT.js";import"./colors-CDlQsefj.js";import"./collapseMotion-CW4DPm-L.js";import"./slide-DCDZKjHj.js";import"./useRefs-DsN55d7I.js";import"./hasIn-1TLaJpEW.js";import"./isMobile-8sZ0LT6r.js";import"./useMergedState-DAlpYor9.js";import"./isPlainObject-Cfyj4D1A.js";const le={class:"relative flex flex-col items-center"},ce=["src"],me={class:"absolute bottom-3 left-0 z-10 block h-7 w-full text-center text-xs leading-[30px] text-white"},de={key:1,class:"bg-black/30"},ue=C({__name:"index",props:$({diffDegree:{default:20},imageSize:{default:260},imageWrapperStyle:{},maxDegree:{default:300},minDegree:{default:120},src:{default:""},defaultTip:{default:""}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:$(["success"],["update:modelValue"]),setup(o,{expose:s,emit:r}){const n=o,m=r,g=H("slideBarRef"),e=J({currentRotate:0,dragging:!1,endTime:0,imgStyle:{},isPassing:!1,randomRotate:0,showTip:!1,startTime:0,toOrigin:!1}),h=K(o,"modelValue");Q(()=>e.isPassing,t=>{if(t){const{endTime:a,startTime:i}=e,l=(a-i)/1e3;m("success",{isPassing:t,time:l.toFixed(1)})}h.value=t});const P=d(()=>{const{imageSize:t,imageWrapperStyle:a}=n;return M({height:`${t}px`,width:`${t}px`},a)}),E=d(()=>{const{maxDegree:t,minDegree:a}=n;return a>t&&console.warn("minDegree should not be greater than maxDegree"),a===t?Math.floor(1+Math.random()*1)/10+1:1});function F(){e.startTime=Date.now()}function I(t){e.dragging=!0;const{imageSize:a,maxDegree:i}=n,{moveX:l}=t,u=a;if(u===0)return;const w=Math.ceil(l/u*1.5*i*c(E));e.currentRotate=w,v(e.randomRotate-w)}function T(){const{maxDegree:t,minDegree:a}=n,i=Math.floor(a+Math.random()*(t-a));e.randomRotate=i,v(i)}function O(){const{currentRotate:t,randomRotate:a}=e,{diffDegree:i}=n;Math.abs(a-t)>=(i||20)?(v(a),e.toOrigin=!0,re(()=>{e.toOrigin=!1,e.showTip=!0},300)):L(),e.showTip=!0,e.dragging=!1}function v(t){e.imgStyle={transform:`rotateZ(${t}deg)`}}function L(){e.isPassing=!0,e.endTime=Date.now()}function D(){e.showTip=!1;const t=c(g);t&&(e.isPassing=!1,t.resume(),T())}const A=d(()=>e.toOrigin?["transition-transform duration-300"]:[]),N=d(()=>e.isPassing?_("ui.captcha.sliderRotateSuccessTip",[((e.endTime-e.startTime)/1e3).toFixed(1)]):_("ui.captcha.sliderRotateFailTip"));return s({resume:D}),(t,a)=>(f(),x("div",le,[p("div",{style:B(P.value),class:"border-border relative cursor-pointer overflow-hidden rounded-full border shadow-md"},[p("img",{class:V([A.value,"w-full rounded-full"]),src:o.src,style:B(e.imgStyle),alt:"verify",onClick:D,onLoad:T},null,46,ce),p("div",me,[e.showTip?(f(),x("div",{key:0,class:V({"bg-success/80":e.isPassing,"bg-destructive/80":!e.isPassing})},z(N.value),3)):k("",!0),e.dragging?k("",!0):(f(),x("div",de,z(o.defaultTip||c(_)("ui.captcha.sliderRotateDefaultTip")),1))])],4),R(G,{ref_key:"slideBarRef",ref:g,modelValue:h.value,"onUpdate:modelValue":a[0]||(a[0]=i=>h.value=i),class:"mt-5","is-slot":"",onEnd:O,onMove:I,onStart:F},Y({_:2},[ee(t.$slots,(i,l)=>({name:l,fn:S(u=>[te(t.$slots,l,ae(se(u)))])}))]),1032,["modelValue"])]))}}),fe={class:"flex items-center justify-center p-4"},Fe=C({__name:"slider-rotate-captcha",setup(o){const s=X();function r(){Z.success("success!")}const n=d(()=>{var m;return((m=s.userInfo)==null?void 0:m.avatar)||oe.app.defaultAvatar});return(m,g)=>(f(),ie(c(ne),{description:"用于前端简单的拖动校验场景",title:"滑块旋转校验"},{default:S(()=>[R(c(q),{class:"mb-5",title:"基本示例"},{default:S(()=>[p("div",fe,[R(c(ue),{src:n.value,onSuccess:r},null,8,["src"])])]),_:1})]),_:1}))}});export{Fe as default};
