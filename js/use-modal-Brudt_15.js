var Ze=Object.defineProperty,et=Object.defineProperties;var tt=Object.getOwnPropertyDescriptors;var le=Object.getOwnPropertySymbols;var xe=Object.prototype.hasOwnProperty,Be=Object.prototype.propertyIsEnumerable;var de=(o,t,s)=>t in o?Ze(o,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[t]=s,f=(o,t)=>{for(var s in t||(t={}))xe.call(t,s)&&de(o,s,t[s]);if(le)for(var s of le(t))Be.call(t,s)&&de(o,s,t[s]);return o},R=(o,t)=>et(o,tt(t));var K=(o,t)=>{var s={};for(var a in o)xe.call(o,a)&&t.indexOf(a)<0&&(s[a]=o[a]);if(o!=null&&le)for(var a of le(o))t.indexOf(a)<0&&Be.call(o,a)&&(s[a]=o[a]);return s};var W=(o,t,s)=>de(o,typeof t!="symbol"?t+"":t,s);var J=(o,t,s)=>new Promise((a,l)=>{var i=m=>{try{C(s.next(m))}catch(d){l(d)}},u=m=>{try{C(s.throw(m))}catch(d){l(d)}},C=m=>m.done?a(m.value):Promise.resolve(m.value).then(i,u);C((s=s.apply(o,t)).next())});import{d as $,D as h,n as p,u as e,R as ot,S as st,E as y,z as g,i as Ae,m as ue,c as L,r as _,az as at,j as Y,q as w,B as nt,x as N,y as A,G as pe,b as $e,e as lt,a as rt,o as it,aF as ce,aA as dt,w as ct,aB as ut,v as pt,H as G,A as Q,Q as we,C as fe,p as Te,aC as ft,au as mt,a1 as ke}from"../jse/index-index-Dn7Pga_E.js";import{q as Ee,aY as Se,c6 as ht,aH as yt,w as Le,c7 as vt,c8 as gt,c9 as Ct,ca as bt,cb as xt,cc as Bt,cd as wt,bj as kt,bo as Ot,U as Oe,ce as Dt,cf as Mt}from"./bootstrap-CmOIY23B.js";import{D as _t,a as At,b as $t,c as Tt,d as Et}from"./DialogTitle-yaBRErHk.js";import{X as St}from"./x-BOl5kJMD.js";const Lt=Ee("expand",[["path",{d:"m15 15 6 6",key:"1s409w"}],["path",{d:"m15 9 6-6",key:"ko1vev"}],["path",{d:"M21 16v5h-5",key:"1ck2sf"}],["path",{d:"M21 8V3h-5",key:"1qoq8a"}],["path",{d:"M3 16v5h5",key:"1t08am"}],["path",{d:"m3 21 6-6",key:"wwnumi"}],["path",{d:"M3 8V3h5",key:"1ln10m"}],["path",{d:"M9 9 3 3",key:"v551iv"}]]);const Pt=Ee("shrink",[["path",{d:"m15 15 6 6m-6-6v4.8m0-4.8h4.8",key:"17vawe"}],["path",{d:"M9 19.8V15m0 0H4.2M9 15l-6 6",key:"chjx8e"}],["path",{d:"M15 4.2V9m0 0h4.8M15 9l6-6",key:"lav6yq"}],["path",{d:"M9 4.2V9m0 0H4.2M9 9 3 3",key:"1pxi2q"}]]),zt=$({__name:"Dialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(o,{emit:t}){const l=Se(o,t);return(i,u)=>(p(),h(e(_t),ot(st(e(l))),{default:y(()=>[g(i.$slots,"default")]),_:3},16))}}),It=["data-dismissable-modal"],Ft=$({__name:"DialogOverlay",setup(o){ht();const t=Ae("DISMISSABLE_MODAL_ID");return(s,a)=>(p(),ue("div",{"data-dismissable-modal":e(t),class:"z-popup inset-0 bg-overlay"},null,8,It))}}),Vt=$({__name:"DialogContent",props:{forceMount:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},animationType:{default:"slide"},appendTo:{default:"body"},class:{},closeClass:{},closeDisabled:{type:Boolean,default:!1},modal:{type:Boolean},open:{type:Boolean},overlayBlur:{},showClose:{type:Boolean,default:!0},zIndex:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus","close","closed","opened"],setup(o,{expose:t,emit:s}){const a=o,l=s,i=L(()=>{const T=a,{class:r,modal:c,open:x,showClose:B,animationType:k}=T;return K(T,["class","modal","open","showClose","animationType"])});function u(){return a.appendTo==="body"||a.appendTo===document.body||!a.appendTo}const C=L(()=>u()?"fixed":"absolute"),m=Se(i,l),d=_(null);function v(r){var c;r.target===((c=d.value)==null?void 0:c.$el)&&(a.open?l("opened"):l("closed"))}return t({getContentRef:()=>d.value}),(r,c)=>(p(),h(at,{defer:"",to:o.appendTo},[Y(yt,{name:"fade"},{default:y(()=>[o.open&&o.modal?(p(),h(Ft,{key:0,style:nt(R(f({},o.zIndex?{zIndex:o.zIndex}:{}),{position:C.value,backdropFilter:o.overlayBlur&&o.overlayBlur>0?`blur(${o.overlayBlur}px)`:"none"})),onClick:c[0]||(c[0]=()=>l("close"))},null,8,["style"])):w("",!0)]),_:1}),Y(e($t),pe({ref_key:"contentRef",ref:d,style:R(f({},o.zIndex?{zIndex:o.zIndex}:{}),{position:C.value}),onAnimationend:v},e(m),{class:e(A)("z-popup w-full bg-background p-6 shadow-lg outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 sm:rounded-xl",{"data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-top-[48%]":o.animationType==="slide"},a.class)}),{default:y(()=>[g(r.$slots,"default"),o.showClose?(p(),h(e(At),{key:0,disabled:o.closeDisabled,class:N(e(A)("flex-center absolute right-3 top-3 h-6 w-6 rounded-full px-1 text-lg text-foreground/80 opacity-70 transition-opacity hover:bg-accent hover:text-accent-foreground hover:opacity-100 focus:outline-none disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",a.closeClass)),onClick:c[1]||(c[1]=()=>l("close"))},{default:y(()=>[Y(e(St),{class:"h-4 w-4"})]),_:1},8,["disabled","class"])):w("",!0)]),_:3},16,["style","class"])],8,["to"]))}}),De=$({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=L(()=>{const u=t,{class:l}=u;return K(u,["class"])}),a=Le(s);return(l,i)=>(p(),h(e(Tt),pe(e(a),{class:e(A)("text-sm text-muted-foreground",t.class)}),{default:y(()=>[g(l.$slots,"default")]),_:3},16,["class"]))}}),Rt=$({__name:"DialogFooter",props:{class:{}},setup(o){const t=o;return(s,a)=>(p(),ue("div",{class:N(e(A)("flex flex-row flex-col-reverse justify-end gap-x-2",t.class))},[g(s.$slots,"default")],2))}}),Nt=$({__name:"DialogHeader",props:{class:{}},setup(o){const t=o;return(s,a)=>(p(),ue("div",{class:N(e(A)("flex flex-col gap-y-1.5 text-center sm:text-left",t.class))},[g(s.$slots,"default")],2))}}),Me=$({__name:"DialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=L(()=>{const u=t,{class:l}=u;return K(u,["class"])}),a=Le(s);return(l,i)=>(p(),h(e(Et),pe(e(a),{class:e(A)("text-lg font-semibold leading-none tracking-tight",t.class)}),{default:y(()=>[g(l.$slots,"default")]),_:3},16,["class"]))}});function Yt(o,t,s,a,l){const i=$e({offsetX:0,offsetY:0}),u=_(!1),C=r=>{const c=r.clientX,x=r.clientY;if(!o.value)return;const B=o.value.getBoundingClientRect(),{offsetX:k,offsetY:D}=i,T=B.left,F=B.top,Z=B.width,ee=B.height;let P=null;if(a!=null&&a.value){const M=document.querySelector(a.value);M&&(P=M.getBoundingClientRect())}let X,H,z,q;if(P)z=P.left-T+k,X=P.right-T-Z+k,q=P.top-F+D,H=P.bottom-F-ee+D;else{const M=document.documentElement,O=M.clientWidth,E=M.clientHeight;z=-T+k,q=-F+D,X=O-T-Z+k,H=E-F-ee+D}const te=M=>{let O=k+M.clientX-c,E=D+M.clientY-x;if(O=Math.min(Math.max(O,z),X),E=Math.min(Math.max(E,q),H),i.offsetX=O,i.offsetY=E,o.value){const se=l==null?void 0:l.value;o.value.style.transform=se?`translate(${O}px, calc(-50% + ${E}px))`:`translate(${O}px, ${E}px)`,u.value=!0}},oe=()=>{u.value=!1,document.removeEventListener("mousemove",te),document.removeEventListener("mouseup",oe)};document.addEventListener("mousemove",te),document.addEventListener("mouseup",oe)},m=()=>{const r=ce(t);r&&o.value&&r.addEventListener("mousedown",C)},d=()=>{const r=ce(t);r&&o.value&&r.removeEventListener("mousedown",C)},v=()=>{i.offsetX=0,i.offsetY=0;const r=ce(o);r&&(r.style.transform="")};return lt(()=>{rt(()=>{s.value?m():d()})}),it(()=>{d()}),{dragging:u,resetPosition:v,transform:i}}const Xt=$({__name:"modal",props:{modalApi:{default:void 0},animationType:{},appendToMain:{type:Boolean,default:!1},bordered:{type:Boolean},cancelText:{},centered:{type:Boolean},class:{},closable:{type:Boolean},closeOnClickModal:{type:Boolean},closeOnPressEscape:{type:Boolean},confirmDisabled:{type:Boolean},confirmLoading:{type:Boolean},confirmText:{},contentClass:{},description:{},destroyOnClose:{type:Boolean,default:!1},draggable:{type:Boolean},footer:{type:Boolean},footerClass:{},fullscreen:{type:Boolean},fullscreenButton:{type:Boolean},header:{type:Boolean},headerClass:{},loading:{type:Boolean},modal:{type:Boolean},openAutoFocus:{type:Boolean},overlayBlur:{},showCancelButton:{type:Boolean},showConfirmButton:{type:Boolean},submitting:{type:Boolean},title:{},titleTooltip:{},zIndex:{}},setup(o){var ne,be;const t=o,s=vt.getComponents(),a=_(),l=_(),i=_(),u=_(),C=_(),m=dt();Te("DISMISSABLE_MODAL_ID",m);const{$t:d}=gt(),{isMobile:v}=Ct(),r=(be=(ne=t.modalApi)==null?void 0:ne.useStore)==null?void 0:be.call(ne),{appendToMain:c,bordered:x,cancelText:B,centered:k,class:D,closable:T,closeOnClickModal:F,closeOnPressEscape:Z,confirmDisabled:ee,confirmLoading:P,confirmText:X,contentClass:H,description:z,destroyOnClose:q,draggable:te,footer:oe,footerClass:M,fullscreen:O,fullscreenButton:E,header:se,headerClass:Pe,loading:me,modal:ze,openAutoFocus:Ie,overlayBlur:Fe,showCancelButton:Ve,showConfirmButton:Re,submitting:S,title:ae,titleTooltip:he,animationType:Ne,zIndex:Ye}=bt(t,r),j=L(()=>O.value||v.value),ye=L(()=>te.value&&!j.value&&se.value),ve=L(()=>k.value&&!j.value),ge=L(()=>c.value?`#${xt}>div:not(.absolute)>div`:void 0),{dragging:Xe,transform:He}=Yt(i,u,ye,ge,ve),re=_(!1),ie=_(!0);ct(()=>{var n;return(n=r==null?void 0:r.value)==null?void 0:n.isOpen},n=>J(null,null,function*(){if(n){if(ie.value=!1,re.value||(re.value=!0),yield fe(),!a.value)return;const b=a.value.getContentRef();i.value=b.$el;const{offsetX:V,offsetY:I}=He;i.value.style.transform=ve.value?`translate(${V}px, calc(-50% + ${I}px))`:`translate(${V}px, ${I}px)`}}),{immediate:!0}),ut(()=>{var n;c.value||(n=t.modalApi)==null||n.close()});function qe(){var n;(n=t.modalApi)==null||n.setState(b=>R(f({},b),{fullscreen:!O.value}))}function je(n){(!F.value||S.value)&&(n.preventDefault(),n.stopPropagation())}function Ue(n){(!Z.value||S.value)&&n.preventDefault()}function Ke(n){Ie.value||n==null||n.preventDefault()}function We(n){const b=n.target,V=b==null?void 0:b.dataset.dismissableModal;(!F.value||V!==m||S.value)&&(n.preventDefault(),n.stopPropagation())}function Ce(n){n.preventDefault(),n.stopPropagation()}const Je=L(()=>!e(q)&&e(re)),Ge=()=>{requestAnimationFrame(()=>{var n;(n=t.modalApi)==null||n.onOpened()})};function Qe(){var n;ie.value=!0,(n=t.modalApi)==null||n.onClosed()}return(n,b)=>{var V;return p(),h(e(zt),{modal:!1,open:(V=e(r))==null?void 0:V.isOpen,"onUpdate:open":b[2]||(b[2]=()=>{var I;return e(S)||(I=o.modalApi)==null?void 0:I.close()})},{default:y(()=>{var I;return[Y(e(Vt),{ref_key:"contentRef",ref:a,"append-to":ge.value,class:N(e(A)("left-0 right-0 top-[10vh] mx-auto flex max-h-[80%] w-[520px] flex-col p-0",j.value?"sm:rounded-none":"sm:rounded-[var(--radius)]",e(D),{"border border-border":e(x),"shadow-3xl":!e(x),"left-0 top-0 size-full max-h-full !translate-x-0 !translate-y-0":j.value,"top-1/2":e(k)&&!j.value,"duration-300":!e(Xe),hidden:ie.value})),"force-mount":Je.value,modal:e(ze),open:(I=e(r))==null?void 0:I.isOpen,"show-close":e(T),"animation-type":e(Ne),"z-index":e(Ye),"overlay-blur":e(Fe),"close-class":"top-3",onCloseAutoFocus:Ce,onClosed:Qe,"close-disabled":e(S),onEscapeKeyDown:Ue,onFocusOutside:Ce,onInteractOutside:je,onOpenAutoFocus:Ke,onOpened:Ge,onPointerDownOutside:We},{default:y(()=>[Y(e(Nt),{ref_key:"headerRef",ref:u,class:N(e(A)("px-5 py-4",{"border-b":e(x),hidden:!e(se),"cursor-move select-none":ye.value},e(Pe)))},{default:y(()=>[e(ae)?(p(),h(e(Me),{key:0,class:"text-left"},{default:y(()=>[g(n.$slots,"title",{},()=>[G(Q(e(ae))+" ",1),e(he)?g(n.$slots,"titleTooltip",{key:0},()=>[Y(e(Bt),{"trigger-class":"pb-1"},{default:y(()=>[G(Q(e(he)),1)]),_:1})]):w("",!0)])]),_:3})):w("",!0),e(z)?(p(),h(e(De),{key:1},{default:y(()=>[g(n.$slots,"description",{},()=>[G(Q(e(z)),1)])]),_:3})):w("",!0),!e(ae)||!e(z)?(p(),h(e(wt),{key:2},{default:y(()=>[e(ae)?w("",!0):(p(),h(e(Me),{key:0})),e(z)?w("",!0):(p(),h(e(De),{key:1}))]),_:1})):w("",!0)]),_:3},8,["class"]),pt("div",{ref_key:"wrapperRef",ref:l,class:N(e(A)("relative min-h-40 flex-1 overflow-y-auto p-3",e(H),{"pointer-events-none":e(me)||e(S)}))},[g(n.$slots,"default")],2),e(me)||e(S)?(p(),h(e(kt),{key:0,spinning:""})):w("",!0),e(E)?(p(),h(e(Ot),{key:1,class:"flex-center absolute right-10 top-3 hidden size-6 rounded-full px-1 text-lg text-foreground/80 opacity-70 transition-opacity hover:bg-accent hover:text-accent-foreground hover:opacity-100 focus:outline-none disabled:pointer-events-none sm:block",onClick:qe},{default:y(()=>[e(O)?(p(),h(e(Pt),{key:0,class:"size-3.5"})):(p(),h(e(Lt),{key:1,class:"size-3.5"}))]),_:1})):w("",!0),e(oe)?(p(),h(e(Rt),{key:2,ref_key:"footerRef",ref:C,class:N(e(A)("flex-row items-center justify-end p-2",{"border-t":e(x)},e(M)))},{default:y(()=>[g(n.$slots,"prepend-footer"),g(n.$slots,"footer",{},()=>[e(Ve)?(p(),h(we(e(s).DefaultButton||e(Oe)),{key:0,variant:"ghost",disabled:e(S),onClick:b[0]||(b[0]=()=>{var U;return(U=o.modalApi)==null?void 0:U.onCancel()})},{default:y(()=>[g(n.$slots,"cancelText",{},()=>[G(Q(e(B)||e(d)("cancel")),1)])]),_:3},8,["disabled"])):w("",!0),g(n.$slots,"center-footer"),e(Re)?(p(),h(we(e(s).PrimaryButton||e(Oe)),{key:1,disabled:e(ee),loading:e(P)||e(S),onClick:b[1]||(b[1]=()=>{var U;return(U=o.modalApi)==null?void 0:U.onConfirm()})},{default:y(()=>[g(n.$slots,"confirmText",{},()=>[G(Q(e(X)||e(d)("confirm")),1)])]),_:3},8,["disabled","loading"])):w("",!0)]),g(n.$slots,"append-footer")]),_:3},8,["class"])):w("",!0)]),_:3},8,["append-to","class","force-mount","modal","open","show-close","animation-type","z-index","overlay-blur","close-disabled"])]}),_:3},8,["open"])}}});class Ht{constructor(t={}){W(this,"sharedData",{payload:{}});W(this,"store");W(this,"api");W(this,"state");const r=t,{connectedComponent:s,onBeforeClose:a,onCancel:l,onClosed:i,onConfirm:u,onOpenChange:C,onOpened:m}=r,d=K(r,["connectedComponent","onBeforeClose","onCancel","onClosed","onConfirm","onOpenChange","onOpened"]),v={bordered:!0,centered:!1,class:"",closeOnClickModal:!0,closeOnPressEscape:!0,confirmDisabled:!1,confirmLoading:!1,contentClass:"",destroyOnClose:!0,draggable:!1,footer:!0,footerClass:"",fullscreen:!1,fullscreenButton:!0,header:!0,headerClass:"",isOpen:!1,loading:!1,modal:!0,openAutoFocus:!1,showCancelButton:!0,showConfirmButton:!0,title:"",animationType:"slide"};this.store=new Dt(f(f({},v),d),{onUpdate:()=>{var x,B,k;const c=this.store.state;(c==null?void 0:c.isOpen)===((x=this.state)==null?void 0:x.isOpen)?this.state=c:(this.state=c,(k=(B=this.api).onOpenChange)==null||k.call(B,!!(c!=null&&c.isOpen)))}}),this.state=this.store.state,this.api={onBeforeClose:a,onCancel:l,onClosed:i,onConfirm:u,onOpenChange:C,onOpened:m},ft(this)}close(){return J(this,null,function*(){var s,a,l;((l=yield(a=(s=this.api).onBeforeClose)==null?void 0:a.call(s))!=null?l:!0)&&this.store.setState(i=>R(f({},i),{isOpen:!1}))})}getData(){var t,s;return(s=(t=this.sharedData)==null?void 0:t.payload)!=null?s:{}}lock(t=!0){return this.setState({submitting:t})}onCancel(){var t,s;this.api.onCancel?(s=(t=this.api).onCancel)==null||s.call(t):this.close()}onClosed(){var t,s;this.state.isOpen||(s=(t=this.api).onClosed)==null||s.call(t)}onConfirm(){var t,s;(s=(t=this.api).onConfirm)==null||s.call(t)}onOpened(){var t,s;this.state.isOpen&&((s=(t=this.api).onOpened)==null||s.call(t))}open(){this.store.setState(t=>R(f({},t),{isOpen:!0,submitting:!1}))}setData(t){return this.sharedData.payload=t,this}setState(t){return mt(t)?this.store.setState(t):this.store.setState(s=>f(f({},s),t)),this}unlock(){return this.lock(!1)}}const _e=Symbol("VBEN_MODAL_INJECT"),qt={};function Qt(o={}){var m;const{connectedComponent:t}=o;if(t){const d=$e({}),v=_(!0);return[$((c,{attrs:x,slots:B})=>(Te(_e,{extendApi(D){Object.setPrototypeOf(d,D)},options:o,reCreateModal(){return J(this,null,function*(){v.value=!1,yield fe(),v.value=!0})}}),jt(d,f(f(f({},c),x),B)),()=>ke(v.value?t:"div",f(f({},c),x),B)),{name:"VbenParentModal",inheritAttrs:!1}),d]}const s=Ae(_e,{}),a=f(f(f({},qt),s.options),o);a.onOpenChange=d=>{var v,r,c;(v=o.onOpenChange)==null||v.call(o,d),(c=(r=s.options)==null?void 0:r.onOpenChange)==null||c.call(r,d)};const l=a.onClosed;a.onClosed=()=>{var d;l==null||l(),a.destroyOnClose&&((d=s.reCreateModal)==null||d.call(s))};const i=new Ht(a),u=i;u.useStore=d=>Mt(i.store,d);const C=$((d,{attrs:v,slots:r})=>()=>ke(Xt,R(f(f({},d),v),{modalApi:u}),r),{name:"VbenModal",inheritAttrs:!1});return(m=s.extendApi)==null||m.call(s,u),[C,u]}function jt(o,t){return J(this,null,function*(){var l;if(!t||Object.keys(t).length===0)return;yield fe();const s=(l=o==null?void 0:o.store)==null?void 0:l.state;if(!s)return;const a=new Set(Object.keys(s));for(const i of Object.keys(t))a.has(i)&&!["class"].includes(i)&&console.warn(`[Vben Modal]: When 'connectedComponent' exists, do not set props or slots '${i}', which will increase complexity. If you need to modify the props of Modal, please use useVbenModal or api.`)})}export{Qt as u};
